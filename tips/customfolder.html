<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>カスタムフォルダのメモ
| Hex bms</title><link rel=stylesheet href=/book.min.c7ca503dc0eee7cd65c70aa8921cddb4c95acea2bc44854107f47be0f9f8d755.css></head><body><input type=checkbox style=display:none id=menu-control><main class="flex container"><aside class="book-menu fixed"><nav><h2 class=book-brand><a href=http://bms.hexlataia.xyz/>Hex bms</a></h2><ul><li><span>難易度表</span><ul><li><a href=/tables/hexajoy.html>Hexajoy</a></li><li><a href=/tables/tanosi.html>ジャパリパーク</a></li><li><a href=/tables/sandbox.html>砂場</a></li><li class=nazo><a href=/tables/hinanjoy.html>避難Joy</a></li><li class=nazo><a href=/tables/olduploader.html>旧アプロダ表</a></li><li class=nazo><a href=/tables/db.html>発狂難易度データベース（仮）</a></li><li class=nazo><a href=/tables/convert/>いろいろ勝手にjson化したい</a></li></ul></li><li><span>メモ</span><ul><li><a href=/tips/googleapps.html>スプレッドシートを使った難易度表の管理</a></li><li><a href=/tips/glassist.html>GLAssistの差分自動導入</a></li><li><a href=/tips/customfolder.html class=active>カスタムフォルダのメモ</a></li></ul></li><li><span>その他</span><ul><li><a href=/others/editorskin.html>エディタ用スキン</a></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector('aside.book-menu nav')
addEventListener('beforeunload',function(event){localStorage.setItem('menu.scrollTop',menu.scrollTop)});menu.scrollTop=localStorage.getItem('menu.scrollTop')})()</script></aside><div class=book-page><header class="align-center justify-between book-header"><label for=menu-control><img src=/svg/menu.svg alt=Menu></label>
<strong>カスタムフォルダのメモ</strong></header><article class=markdown><h1 id=カスタムフォルダのメモ>カスタムフォルダのメモ</h1><p>自分が使っているちょっと特殊なカスタムフォルダのコマンドを晒すだけ</p><h2 id=カスタムフォルダのコマンドの基本>カスタムフォルダのコマンドの基本</h2><p>カスタムフォルダのコマンドはsong.dbにプレイヤー名.dbをattachしたうえで</p><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#007020;font-weight:700>SELECT</span> <span style=color:#666>*</span> <span style=color:#007020;font-weight:700>FROM</span> song <span style=color:#007020;font-weight:700>WHERE</span> (command) <span style=color:#007020;font-weight:700>INNER</span> <span style=color:#007020;font-weight:700>JOIN</span> <span style=color:#007020;font-weight:700>ON</span> song.hash<span style=color:#666>=</span>score.hash</code></pre></div><p>の(command)の部分を定義している。（LR2のデータベースは<a href=https://www.sqlite.org/index.html>sqlite3</a>）（LR2のヘルプを参照）</p><p><a href=http://sqlitebrowser.org/>SQLite Database Browser</a>などを用いればデータベースの中身を見たりコマンドをテストしたり出来る。</p><h2 id=ランダムでソートする>ランダムでソートする</h2><p>結果をランダムでソートして表示する。</p><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#666>#</span>COMMAND (<span>適当なコマンド</span>) <span style=color:#007020;font-weight:700>ORDER</span> <span style=color:#007020;font-weight:700>BY</span> RANDOM()</code></pre></div><p>RANDOM()はsqliteの乱数を生成する関数。</p><h2 id=irでのスコア偏差値が低い-高い-順にソートする>IRでのスコア偏差値が低い（高い）順にソートする</h2><p>BeMusicSeekerの機能をカスタムフォルダで使用する。<strong>BeMusicSeekerの導入必須</strong>。</p><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#666>#</span>COMMAND (<span>適当なコマンド</span>) <span style=color:#007020;font-weight:700>ORDER</span> <span style=color:#007020;font-weight:700>BY</span>(perfect<span style=color:#666>*</span><span style=color:#40a070>2</span><span style=color:#666>+</span>great<span style=color:#666>-</span>(<span style=color:#007020;font-weight:700>SELECT</span> average <span style=color:#007020;font-weight:700>FROM</span> ir_data <span style=color:#007020;font-weight:700>WHERE</span> hash <span style=color:#666>=</span> song.hash))<span style=color:#666>*</span><span style=color:#40a070>10</span><span style=color:#666>/</span>(<span style=color:#007020;font-weight:700>SELECT</span> sigma <span style=color:#007020;font-weight:700>FROM</span> ir_data <span style=color:#007020;font-weight:700>WHERE</span> hash <span style=color:#666>=</span> song.hash)<span style=color:#666>+</span><span style=color:#40a070>50</span> <span style=color:#007020;font-weight:700>ASC</span></code></pre></div><p>最後のASCをDESCに変更すれば高い順にソートになります。</p><p>内部結合が使えないのでサブクエリを使って強引に実装。</p><h2 id=複数の表をマージする>複数の表をマージする</h2><p>BeMusicSeekerで表を導入している場合。</p><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#666>#</span>COMMAND song.hash <span style=color:#007020;font-weight:700>in</span> (<span style=color:#007020;font-weight:700>SELECT</span> md5 <span style=color:#007020;font-weight:700>FROM</span> playlist_entry <span style=color:#007020;font-weight:700>WHERE</span> playlist_id <span style=color:#007020;font-weight:700>in</span> (<span style=color:#40a070>1</span>,<span style=color:#40a070>2</span>,<span style=color:#40a070>3</span>) <span style=color:#007020;font-weight:700>AND</span> folder <span style=color:#666>=</span> <span style=color:#4070a0>&#39;LEVEL 1&#39;</span> <span style=color:#007020;font-weight:700>AND</span> is_removed <span style=color:#666>=</span> <span style=color:#40a070>0</span>)</code></pre></div><p>playlist_id in (1,2,3)の(1,2,3)の中に表のplaylist_idを入力。</p><p>playlist_idはその表のカスタムフォルダの中身を見たりSQLite Database Browser使ったりして確認。</p></article><div class="book-footer justify-between"><div><img src=/svg/calendar.svg alt=Changed> 2019-6-27</div></div></div><aside class="book-toc level-6 fixed"><nav id=TableOfContents><ul><li><a href=#カスタムフォルダのメモ>カスタムフォルダのメモ</a><ul><li><a href=#カスタムフォルダのコマンドの基本>カスタムフォルダのコマンドの基本</a></li><li><a href=#ランダムでソートする>ランダムでソートする</a></li><li><a href=#irでのスコア偏差値が低い-高い-順にソートする>IRでのスコア偏差値が低い（高い）順にソートする</a></li><li><a href=#複数の表をマージする>複数の表をマージする</a></li></ul></li></ul></nav></aside></main></body></html>